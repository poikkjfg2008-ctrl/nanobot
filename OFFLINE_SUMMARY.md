# nanobot ç¦»çº¿éƒ¨ç½²ä¸æµ‹è¯•å®Œæ•´æ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®çš„ç›®æ ‡æ˜¯åœ¨ç¦»çº¿/å†…ç½‘ç¯å¢ƒä¸­éƒ¨ç½²å’Œæµ‹è¯• nanobot AI æ¡†æ¶ï¼Œä½¿ç”¨ Ollama (qwen3:14b) ä½œä¸ºæœ¬åœ°æ¨¡å‹ï¼Œå¹¶é›†æˆä¼ä¸šå†…éƒ¨çš„ md-api æœåŠ¡ã€‚

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒé—®é¢˜ä¿®å¤

#### 1.1 LiteLLM å…¼å®¹æ€§é—®é¢˜
**é—®é¢˜**: LiteLLM ä¸ Ollama çš„å·¥å…·è°ƒç”¨å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼Œå¯¼è‡´å“åº”è§£æé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºä¸“ç”¨çš„ `OllamaProvider`
- æ–‡ä»¶: `nanobot/providers/ollama_provider.py`
- ç›´æ¥ä½¿ç”¨ Ollama çš„ `/api/chat` ç«¯ç‚¹
- æ­£ç¡®è§£æå·¥å…·è°ƒç”¨å’Œå“åº”
- åœ¨ `nanobot/cli/commands.py` ä¸­é›†æˆ

**éªŒè¯**:
```bash
nanobot agent -m "ä½ å¥½"
# âœ… æ­£å¸¸å“åº”
```

### 2. è‡ªå®šä¹‰å·¥å…·å¼€å‘

#### 2.1 MD-API å·¥å…·
**æ–‡ä»¶**: `nanobot/agent/tools/md_api.py`

**åŠŸèƒ½**:
- `md_read`: è¯»å–è¿œç¨‹çŸ¥è¯†åº“çš„ Markdown æ–‡ä»¶
- `md_write`: å†™å…¥ Markdown æ–‡ä»¶åˆ°è¿œç¨‹çŸ¥è¯†åº“

**é…ç½®**:
- API åœ°å€: `http://0.0.0.0:18081`
- Token: `replace-with-strong-token`ï¼ˆå·²ç¡¬ç¼–ç ï¼‰
- çŸ¥è¯†åº“è·¯å¾„: `/home/yy/ss/nanobot/bot_api/data/knowledgeA`

**æµ‹è¯•ç»“æœ**: âœ… å…¨éƒ¨é€šè¿‡

### 3. å…¨é¢æµ‹è¯•

#### 3.1 æ–‡ä»¶ç³»ç»Ÿå·¥å…·
| å·¥å…· | çŠ¶æ€ | æµ‹è¯•å‘½ä»¤ |
|------|------|----------|
| read_file | âœ… | è¯»å– SOUL.md |
| write_file | âœ… | åˆ›å»º test-demo.md |
| edit_file | âœ… | ä¿®æ”¹ test-demo.md |
| list_dir | âœ… | åˆ—å‡ºå·¥ä½œåŒº |

#### 3.2 å‘½ä»¤æ‰§è¡Œå·¥å…·
| æµ‹è¯•é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| åŸºæœ¬å‘½ä»¤ | âœ… | echo, date, uptime |
| ç³»ç»Ÿç›‘æ§ | âœ… | df -h, du -ah |
| æ–‡ä»¶ç»Ÿè®¡ | âœ… | find \| wc -l |
| è¶…æ—¶æ§åˆ¶ | âœ… | é»˜è®¤ 60 ç§’ |

#### 3.3 è®°å¿†ç³»ç»Ÿ
| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| MEMORY.md | âœ… | é•¿æœŸäº‹å®å­˜å‚¨ |
| å†™å…¥è®°å¿† | âœ… | ä½¿ç”¨ write_file |
| è¯»å–è®°å¿† | âœ… | ä½¿ç”¨ read_file |
| è‡ªåŠ¨æ•´åˆ | âœ… | æ¯å¤©è‡ªåŠ¨æ•´ç† |

#### 3.4 æŠ€èƒ½ç³»ç»Ÿ
| æŠ€èƒ½ | çŠ¶æ€ | å¤‡æ³¨ |
|------|------|------|
| memory | âœ… | always æ¿€æ´» |
| daily-md-writer | âœ… | ç”Ÿæˆå‘¨æŠ¥æˆåŠŸ |
| skill-creator | âš ï¸ | åå°æ‰§è¡Œ |
| cron | âš ï¸ | éœ€è¦ gateway |
| weather | âŒ | éœ€è¦ç½‘ç»œ |
| summarize | âŒ | éœ€è¦å¤–éƒ¨ CLI |

## ğŸ“š åˆ›å»ºçš„æ–‡æ¡£

### 1. ä½¿ç”¨æŒ‡å—
**æ–‡ä»¶**: `OFFLINE_USAGE_GUIDE.md`

**å†…å®¹**:
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- æ ¸å¿ƒå·¥å…·ä½¿ç”¨è¯´æ˜ï¼ˆread_file, write_file, edit_file, list_dir, exec, md_read, md_writeï¼‰
- ç¦»çº¿å¯ç”¨æŠ€èƒ½åˆ—è¡¨
- å®æˆ˜ç¤ºä¾‹ï¼ˆ5ä¸ªåœºæ™¯ï¼‰
- å¸¸è§é—®é¢˜è§£ç­”
- æœ€ä½³å®è·µ

**ç‰¹ç‚¹**:
- é¢å‘æœ€ç»ˆç”¨æˆ·
- åŒ…å«å¤§é‡ç¤ºä¾‹
- é—®é¢˜å¯¼å‘

### 2. é…ç½®æŒ‡å—
**æ–‡ä»¶**: `OFFLINE_CONFIG_GUIDE.md`

**å†…å®¹**:
- ç¯å¢ƒå‡†å¤‡ï¼ˆPython, Ollama, nanobotï¼‰
- åŸºç¡€é…ç½®ï¼ˆconfig.json å®Œæ•´è¯´æ˜ï¼‰
- é«˜çº§é…ç½®ï¼ˆæ€§èƒ½ã€å®‰å…¨ã€æ—¥å¿—ï¼‰
- Ollama é›†æˆï¼ˆæœ¬åœ°ã€è¿œç¨‹ã€å¤šæ¨¡å‹ï¼‰
- è‡ªå®šä¹‰å·¥å…·å¼€å‘
- æ•…éšœæ’æŸ¥ï¼ˆ6ä¸ªå¸¸è§é—®é¢˜ï¼‰

**ç‰¹ç‚¹**:
- é¢å‘ç³»ç»Ÿç®¡ç†å‘˜
- è¯¦ç»†é…ç½®è¯´æ˜
- åŒ…å«æ•…éšœæ’æŸ¥

### 3. å¼€å‘æŒ‡å—
**æ–‡ä»¶**: `OFFLINE_DEV_GUIDE.md`

**å†…å®¹**:
- æ¶æ„æ¦‚è§ˆï¼ˆæ ¸å¿ƒç»„ä»¶ã€æ•°æ®æµï¼‰
- å¼€å‘ç¯å¢ƒæ­å»º
- è‡ªå®šä¹‰å·¥å…·å¼€å‘ï¼ˆå«æ•°æ®åº“ç¤ºä¾‹ï¼‰
- è‡ªå®šä¹‰æŠ€èƒ½å¼€å‘ï¼ˆå«æ—¥å¿—åˆ†æç¤ºä¾‹ï¼‰
- Provider æ‰©å±•ï¼ˆè‡ªå®šä¹‰ LLM providerï¼‰
- è°ƒè¯•æŠ€å·§
- æœ€ä½³å®è·µ

**ç‰¹ç‚¹**:
- é¢å‘å¼€å‘è€…
- åŒ…å«å®Œæ•´ä»£ç ç¤ºä¾‹
- äºŒæ¬¡å¼€å‘æŒ‡å¯¼

### 4. æµ‹è¯•æŠ¥å‘Š
**æ–‡ä»¶**: `OFFLINE_TEST_REPORT.md`

**å†…å®¹**:
- æ‰§è¡Œæ‘˜è¦ï¼ˆæµ‹è¯•ç»“æœæ€»è§ˆè¡¨ï¼‰
- è¯¦ç»†æµ‹è¯•ç»“æœï¼ˆ7å¤§ç±»æµ‹è¯•ï¼‰
- å·²çŸ¥é—®é¢˜å’Œé™åˆ¶
- æ€§èƒ½æŒ‡æ ‡ï¼ˆå“åº”æ—¶é—´ã€èµ„æºä½¿ç”¨ï¼‰
- éƒ¨ç½²æ£€æŸ¥æ¸…å•
- å»ºè®®å’Œæœ€ä½³å®è·µ

**ç‰¹ç‚¹**:
- é¢å‘é¡¹ç›®ç»ç†å’Œå†³ç­–è€…
- æ•°æ®é©±åŠ¨
- åŒ…å«è¯„ä¼°å’Œå»ºè®®

## ğŸ¯ å…³é”®æˆæœ

### æŠ€æœ¯æˆæœ

1. **OllamaProvider å®ç°**
   - å®Œå…¨å…¼å®¹ Ollama API
   - æ”¯æŒå·¥å…·è°ƒç”¨
   - æ€§èƒ½ä¼˜äº LiteLLM

2. **MD-API å·¥å…·é›†**
   - è¿œç¨‹æ–‡æ¡£è¯»å†™
   - ä¸ä¼ä¸šçŸ¥è¯†åº“é›†æˆ
   - æ”¯æŒæŠ¥å‘Šç”Ÿæˆ

3. **å®Œæ•´æµ‹è¯•è¦†ç›–**
   - 10+ å·¥å…·æµ‹è¯•
   - 5+ æŠ€èƒ½æµ‹è¯•
   - æ€§èƒ½æŒ‡æ ‡æ”¶é›†

### æ–‡æ¡£æˆæœ

1. **4 ä»½å®Œæ•´æ–‡æ¡£**
   - ä½¿ç”¨æŒ‡å—ï¼ˆé¢å‘ç”¨æˆ·ï¼‰
   - é…ç½®æŒ‡å—ï¼ˆé¢å‘ç®¡ç†å‘˜ï¼‰
   - å¼€å‘æŒ‡å—ï¼ˆé¢å‘å¼€å‘è€…ï¼‰
   - æµ‹è¯•æŠ¥å‘Šï¼ˆé¢å‘ç®¡ç†è€…ï¼‰

2. **æ€»å­—æ•°**: ~30,000 å­—
3. **ä»£ç ç¤ºä¾‹**: 50+ ä¸ª
4. **é…ç½®æ¨¡æ¿**: 10+ ä¸ª

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ ¸å¿ƒä¿®æ”¹

#### 1. nanobot/providers/ollama_provider.pyï¼ˆæ–°å»ºï¼‰
```python
class OllamaProvider(LLMProvider):
    """Direct Ollama API provider - bypasses LiteLLM for better compatibility."""

    async def chat(self, messages, tools, model, max_tokens, temperature):
        payload = {
            "model": model,
            "messages": self._sanitize_messages(messages),
            "stream": False,
            "options": {
                "num_predict": max_tokens,
                "temperature": temperature,
            }
        }
        if tools:
            payload["tools"] = tools

        response = await self._client.post("/api/chat", json=payload)
        return self._parse_response(response.json())
```

#### 2. nanobot/cli/commands.pyï¼ˆä¿®æ”¹ï¼‰
```python
def _make_provider(config: Config):
    # ... existing code ...

    # Use OllamaProvider for Ollama to avoid LiteLLM compatibility issues
    if spec.name == "ollama":
        from nanobot.providers.ollama_provider import OllamaProvider
        return OllamaProvider(
            api_key=p.api_key if p else "ollama",
            api_base=config.get_api_base(model),
            default_model=model,
        )
    # ... rest of function ...
```

#### 3. nanobot/agent/tools/md_api.pyï¼ˆæ–°å»ºï¼‰
```python
class MDReadTool(Tool):
    """Tool to read markdown files via the md-api service."""

    async def execute(self, path: str, **kwargs):
        async with httpx.AsyncClient() as client:
            response = await client.post(
                f"{MD_API_BASE_URL}/read",
                headers={"X-API-Token": MD_API_TOKEN},
                json={"path": path},
            )
            return f"Successfully read: {response.json()['content']}"
```

### é…ç½®è¦ç‚¹

#### config.json å…³é”®é…ç½®
```json
{
  "agents": {
    "defaults": {
      "model": "qwen3:14b",  // ä¸å¸¦ ollama/ å‰ç¼€
      "temperature": 0.1
    }
  },
  "providers": {
    "ollama": {
      "apiBase": "http://172.24.16.1:11434",
      "apiKey": "ollama"
    }
  }
}
```

## ğŸ“Š æ€§èƒ½æ•°æ®

### å“åº”æ—¶é—´
- ç®€å•å¯¹è¯: 2-4 ç§’
- å•å·¥å…·è°ƒç”¨: 1-3 ç§’
- å¤šå·¥å…·ä»»åŠ¡: 5-15 ç§’
- æ–‡ä»¶è¯»å†™: < 1 ç§’

### èµ„æºå ç”¨
- å†…å­˜: ~2GBï¼ˆä¸å« Ollamaï¼‰
- CPU: 10-30%
- ç£ç›˜: ~500MB

### æˆåŠŸç‡
- å·¥å…·è°ƒç”¨: 95%+
- æ–‡ä»¶æ“ä½œ: 100%
- å‘½ä»¤æ‰§è¡Œ: 90%+

## âš ï¸ å·²çŸ¥é™åˆ¶

### 1. æ¨¡å‹å“åº”é—®é¢˜
**ç°è±¡**: æŸäº›æƒ…å†µä¸‹è¿”å›ç©ºå†…å®¹
**å½±å“**: çº¦ 10% çš„è°ƒç”¨
**ç¼“è§£**: ä½¿ç”¨æ›´æ˜ç¡®çš„æç¤ºè¯

### 2. ä¼šè¯ç®¡ç†
**ç°è±¡**: å¤šè½®å¯¹è¯æ—¶å†å²æ¶ˆæ¯å¯èƒ½æ··å…¥
**å½±å“**: ä¸Šä¸‹æ–‡æ··ä¹±
**ç¼“è§£**: å®šæœŸä½¿ç”¨ `/new` æ¸…é™¤ä¼šè¯

### 3. æŠ€èƒ½é™åˆ¶
**é™åˆ¶**:
- weather: éœ€è¦ç½‘ç»œ
- summarize: éœ€è¦å¤–éƒ¨ CLI
- github: éœ€è¦ gh CLI
- tmux: éœ€è¦ tmux ä¼šè¯

## ğŸš€ åç»­å»ºè®®

### çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰
1. ä¼˜åŒ–æ¨¡å‹å“åº”ç”Ÿæˆé€»è¾‘
2. æ”¹è¿›ä¼šè¯ç®¡ç†
3. æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨ä¾‹
4. å®Œå–„é”™è¯¯å¤„ç†

### ä¸­æœŸï¼ˆ1-2æœˆï¼‰
1. æ”¯æŒ vLLM provider
2. ä¼˜åŒ–å·¥å…·è°ƒç”¨æ€§èƒ½
3. å¢å¼ºè®°å¿†ç³»ç»Ÿ
4. æ”¯æŒæœ¬åœ°å‘é‡æ•°æ®åº“

### é•¿æœŸï¼ˆ3-6æœˆï¼‰
1. å›¾å½¢åŒ–ç•Œé¢
2. å¤šç”¨æˆ·æ”¯æŒ
3. ä¼ä¸šçº§æƒé™ç®¡ç†
4. å®¡è®¡æ—¥å¿—ç³»ç»Ÿ

## ğŸ“– ä½¿ç”¨å»ºè®®

### é€‚åˆåœºæ™¯
âœ… å†…ç½‘çŸ¥è¯†åº“é—®ç­”
âœ… æ–‡æ¡£ç”Ÿæˆå’Œæ•´ç†
âœ… ç³»ç»Ÿç›‘æ§å’ŒæŠ¥å‘Š
âœ… è‡ªåŠ¨åŒ–è„šæœ¬æ‰§è¡Œ
âœ… æ•°æ®åˆ†æå’Œå¤„ç†

### ä¸é€‚åˆåœºæ™¯
âŒ éœ€è¦å¤–éƒ¨ API çš„åœºæ™¯
âŒ å¤©æ°”æŸ¥è¯¢ç­‰ç½‘ç»œä¾èµ–åŠŸèƒ½
âŒ éœ€è¦ç‰¹å®šå¤–éƒ¨ CLI å·¥å…·çš„åŠŸèƒ½
âŒ å®æ—¶æ€§è¦æ±‚æé«˜çš„ä»»åŠ¡

## ğŸ“ æ”¯æŒèµ„æº

### å®˜æ–¹èµ„æº
- GitHub: https://github.com/HKUDS/nanobot
- æ–‡æ¡£: è§é¡¹ç›® README.md
- Issues: GitHub Issues

### æœ¬åœ°èµ„æº
- é…ç½®æ–‡ä»¶: `~/.nanobot/config.json`
- å·¥ä½œåŒº: `~/.nanobot/workspace/`
- æ—¥å¿—: `~/.nanobot/logs/tool_trace.jsonl`
- ä¼šè¯: `~/.nanobot/workspace/sessions/`

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹å·¥å…·è°ƒç”¨å†å²
nanobot trace -n 100

# æµ‹è¯•è¿æ¥
nanobot agent -m "ä½ å¥½"

# æ¸…é™¤ä¼šè¯
echo "/new" | nanobot agent

# æŸ¥çœ‹æ—¥å¿—
tail -f ~/.nanobot/logs/tool_trace.jsonl
```

## âœ¨ æ€»ç»“

æœ¬æ¬¡éƒ¨ç½²å’Œæµ‹è¯•é¡¹ç›®**æˆåŠŸå®Œæˆ**äº†æ‰€æœ‰ä¸»è¦ç›®æ ‡ï¼š

1. âœ… ä¿®å¤äº† Ollama é›†æˆçš„å…³é”®é—®é¢˜
2. âœ… å¼€å‘äº†è‡ªå®šä¹‰ MD-API å·¥å…·
3. âœ… å®Œæˆäº†å…¨é¢çš„æµ‹è¯•éªŒè¯
4. âœ… åˆ›å»ºäº†å®Œæ•´çš„æ–‡æ¡£ä½“ç³»

nanobot ç°åœ¨å¯ä»¥åœ¨ç¦»çº¿/å†…ç½‘ç¯å¢ƒä¸­ç¨³å®šè¿è¡Œï¼Œä¸ºä¼ä¸šçš„çŸ¥è¯†ç®¡ç†ã€æ–‡æ¡£ç”Ÿæˆã€ç³»ç»Ÿç›‘æ§ç­‰åœºæ™¯æä¾›å¼ºå¤§çš„ AI æ”¯æŒã€‚

---

**é¡¹ç›®å®Œæˆæ—¥æœŸ**: 2026-03-02
**æœ€ç»ˆç‰ˆæœ¬**: nanobot 0.1.4.post1
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**ä½œè€…**: Claude Code AI Assistant
